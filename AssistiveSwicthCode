#include <BleKeyboard.h>

BleKeyboard bleKeyboard("ESP32 Keyboard");

const int keyCap = 2;
bool lastState = HIGH;

void setup() {
  pinMode(keyCap, INPUT_PULLUP);
  Serial.begin(115200);
  Serial.println("Starting BLE Keyboard...");
  delay(1000);
  bleKeyboard.begin();
}

void loop() {
  if (bleKeyboard.isConnected()) {
    bool currentState = digitalRead(keyCap);

    if (lastState == HIGH && currentState == LOW) {
      Serial.println("Button pressed â€” sending Ctrl+C");

      bleKeyboard.press(KEY_LEFT_CTRL);
      bleKeyboard.press('v');
      delay(100);
      bleKeyboard.releaseAll();

      delay(500); // debounce
    }

    lastState = currentState;
  } else {
    Serial.println("Waiting for BLE connection...");
    delay(1000);
  }
}
